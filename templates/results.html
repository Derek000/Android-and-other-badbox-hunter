<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BadBox Hunter – Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header>
    <h1>BadBox Hunter – Assessment Results</h1>
    <p>Hosts ordered by risk score. Review the “High” entries first.</p>
  </header>

  <main>
    <section class="actions">
      <a href="{{ url_for('index') }}" class="button">← Run another assessment</a>
      <a href="{{ url_for('api_report') }}" class="button secondary">Download JSON report</a>
    </section>

    {% if hosts|length == 0 %}
      <section>
        <p>No hosts were found or the assessment failed.</p>
      </section>
    {% else %}
      <section>
        <table>
          <thead>
            <tr>
              <th>IP</th>
              <th>Hostname</th>
              <th>OS guess</th>
              <th>Tags</th>
              <th>Risk level</th>
              <th>Risk score</th>
              <th>IoC evidence</th>
            </tr>
          </thead>
          <tbody>
            {% for h in hosts %}
              <tr class="risk-{{ h.risk.level|lower }}">
                <td><a href="{{ url_for('host_detail', ip=h.ip) }}">{{ h.ip }}</a></td>
                <td>{{ h.hostname or "" }}</td>
                <td>{{ h.os_guess or "" }}</td>
                <td>{{ ", ".join(h.tags) }}</td>
                <td>{{ h.risk.level }}</td>
                <td>{{ h.risk.score }}</td>
                <td>{{ ", ".join(h.ioc_summary) }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    {% endif %}
  </main>
</body>
</html>
